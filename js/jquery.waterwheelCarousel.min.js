/*!
 * Waterwheel Carousel
 * Version 2.3.0
 * http://www.bkosborne.com
 *
 * Copyright 2011-2013 Brian Osborne
 * Dual licensed under GPLv3 or MIT
 * Copies of the licenses have been distributed
 * with this plugin.
 *
 * Plugin written by Brian Osborne
 * for use with the jQuery JavaScript Framework
 * http://www.jquery.com
 * 
 * for swipe use
 * use jquery touch swipe
 * https://www.npmjs.com/package/jquery-touchswipe
 */
!function(s){"use strict";s.fn.waterwheelCarousel=function(t){if(1<this.length)return this.each(function(){s(this).waterwheelCarousel(t)}),this;var e=this,f={},g={};function i(t){clearTimeout(g.autoPlayTimer),t||0===f.autoPlay||(g.autoPlayTimer=setTimeout(function(){0<f.autoPlay?a("forward"):a("backward")},Math.abs(f.autoPlay)))}function o(t,e){Math.abs(e)<=f.flankingItems+1?(!function(t,e){var i=Math.abs(e);if(i<f.flankingItems+1)var n=g.calculations[i];else n=g.calculations[f.flankingItems+1];var a,r=Math.pow(f.sizeMultiplier,i),o=r*t.data("original_width"),s=r*t.data("original_height"),c=(Math.abs(t.width()-o),Math.abs(t.height()-s),n.offset),l=n.distance;if(e<0&&(l*=-1),"horizontal"==f.orientation)var h=(u=g.containerWidth/2)+l-o/2,d=f.horizon-c-s/2;else{var u=g.containerHeight/2;h=f.horizon-c-o/2,d=u+l-s/2}a=0===e?1:n.opacity;var m=f.flankingItems+2-i;t.data("width",o),t.data("height",s),t.data("top",d),t.data("left",h),t.data("oldPosition",t.data("currentPosition")),t.data("depth",m),t.data("opacity",a)}(t,e),g.itemsAnimating++,t.css("z-index",t.data().depth).animate({left:t.data().left,width:t.data().width,height:t.data().height,top:t.data().top,opacity:t.data().opacity},g.currentSpeed,f.animationEasing,function(){!function(t,e){g.itemsAnimating--,t.data("currentPosition",e),0===e&&(g.currentCenterItem=t);0===g.itemsAnimating&&(g.carouselRotationsLeft-=1,g.currentlyMoving=!1,0<g.carouselRotationsLeft?n(0):(g.currentSpeed=f.speed,g.currentCenterItem.addClass(f.activeClassName),!1===g.performingSetup&&(f.movedToCenter(g.currentCenterItem),f.movedFromCenter(g.previousCenterItem)),g.performingSetup=!1,i()))}(t,e)})):(t.data("currentPosition",e),0===t.data("oldPosition")&&t.css({left:t.data().left,width:t.data().width,height:t.data().height,top:t.data().top,opacity:t.data().opacity,"z-index":t.data().depth}))}function n(t){if(!1===g.currentlyMoving){g.currentCenterItem.removeClass(f.activeClassName),g.currentlyMoving=!0,g.itemsAnimating=0,g.carouselRotationsLeft+=t,!0===f.quickerForFurther&&(1<t&&(g.currentSpeed=f.speed/t),g.currentSpeed=g.currentSpeed<100?100:g.currentSpeed);for(var e=0;e<g.totalItems;e++){var i,n=s(g.items[e]),a=n.data("currentPosition"),r=0<(i="forward"==g.currentDirection?a-1:a+1)?g.rightItemsCount:g.leftItemsCount;Math.abs(i)>r&&(i=-1*a,g.totalItems%2==0&&(i+=1)),o(n,i)}}}function a(t){var e,i;!1===g.currentlyMoving&&(g.previousCenterItem=g.currentCenterItem,f.movingFromCenter(g.currentCenterItem),"backward"==t?(f.movingToCenter(((i=g.currentCenterItem.prev()).length<=0&&(i=g.currentCenterItem.parent().children().last()),i)),g.currentDirection="backward"):"forward"==t&&(f.movingToCenter(((e=g.currentCenterItem.next()).length<=0&&(e=g.currentCenterItem.parent().children().first()),e)),g.currentDirection="forward")),n(1)}return s(this).find("img").bind("click",function(){var t=s(this).data().currentPosition;if(0!=f.imageNav&&!(Math.abs(t)>=f.flankingItems+1||g.currentlyMoving)){g.previousCenterItem=g.currentCenterItem,i(!0),f.autoPlay=0;var e=Math.abs(t);0==t?f.clickedCenter(s(this)):(f.movingFromCenter(g.currentCenterItem),f.movingToCenter(s(this)),t<0?(g.currentDirection="backward",n(e)):0<t&&(g.currentDirection="forward",n(e)))}}),s(this).find("a").bind("click",function(t){var e=0==s(this).find("img").data("currentPosition");if(1===f.linkHandling||2===f.linkHandling&&!e)return t.preventDefault(),!1}),s(document).keydown(function(t){if(f.keyboardNav&&(37===t.which&&"horizontal"==f.orientation||38===t.which&&"vertical"==f.orientation?(i(!0),f.autoPlay=0,a("backward")):(39===t.which&&"horizontal"==f.orientation||40===t.which&&"vertical"==f.orientation)&&(i(!0),f.autoPlay=0,a("forward")),f.keyboardNavOverride&&("horizontal"==f.orientation&&(37===t.which||39===t.which)||"vertical"==f.orientation&&(38===t.which||40===t.which))))return t.preventDefault(),!1}),this.reload=function(t){if("object"==typeof t);else;f=s.extend({},s.fn.waterwheelCarousel.defaults,t),(g={itemsContainer:s(e),totalItems:s(e).find("img").length,containerWidth:s(e).width(),containerHeight:s(e).height(),currentCenterItem:null,previousCenterItem:null,items:[],calculations:[],carouselRotationsLeft:0,currentlyMoving:!1,itemsAnimating:0,currentSpeed:f.speed,intervalTimer:null,currentDirection:"forward",leftItemsCount:0,rightItemsCount:0,performingSetup:!0}).itemsContainer.find("img").removeClass(f.activeClassName),g.itemsContainer.find("img").hide(),f.forcedImageWidth&&f.forcedImageHeight&&g.itemsContainer.find("img").each(function(){s(this).width(f.forcedImageWidth),s(this).height(f.forcedImageHeight)}),function(t){if(!1!==f.preloadImages){var e=g.itemsContainer.find("img"),i=0,n=e.length;e.each(function(){s(this).bind("load",function(){(i+=1)!==n||t()}),s(this).attr("src",s(this).attr("src")),this.complete&&s(this).trigger("load")})}else t()}(function(){g.itemsContainer.find("img").each(function(){(null==s(this).data("original_width")||0<f.forcedImageWidth)&&s(this).data("original_width",s(this).width()),(null==s(this).data("original_height")||0<f.forcedImageHeight)&&s(this).data("original_height",s(this).height())}),function(){g.itemsContainer.find("img:first"),g.calculations[0]={distance:0,offset:0,opacity:1};for(var t=f.horizonOffset,e=f.separation,i=1;i<=f.flankingItems+2;i++)1<i&&(t*=f.horizonOffsetMultiplier,e*=f.separationMultiplier),g.calculations[i]={distance:g.calculations[i-1].distance+e,offset:g.calculations[i-1].offset+t,opacity:g.calculations[i-1].opacity*f.opacityMultiplier};f.edgeFadeEnabled?g.calculations[f.flankingItems+1].opacity=0:g.calculations[f.flankingItems+1]={distance:0,offset:0,opacity:0}}(),function(){g.items=g.itemsContainer.find("img");for(var t=0;t<g.totalItems;t++)g.items[t]=s(g.items[t]);0===f.horizon&&("horizontal"===f.orientation?f.horizon=g.containerHeight/2:f.horizon=g.containerWidth/2),g.itemsContainer.css("position","relative").find("img").each(function(){var t,e;"horizontal"===f.orientation?(t=g.containerWidth/2-s(this).data("original_width")/2,e=f.horizon-s(this).data("original_height")/2):(t=f.horizon-s(this).data("original_width")/2,e=g.containerHeight/2-s(this).data("original_height")/2),s(this).css({left:t,top:e,visibility:"visible",position:"absolute","z-index":0,opacity:0}).data({top:e,left:t,oldPosition:0,currentPosition:0,depth:0,opacity:0}).show()})}(),function(){f.startingItem=0===f.startingItem?Math.round(g.totalItems/2):f.startingItem,g.rightItemsCount=Math.ceil((g.totalItems-1)/2),g.leftItemsCount=Math.floor((g.totalItems-1)/2),g.carouselRotationsLeft=1,o(g.items[f.startingItem-1],0),g.items[f.startingItem-1].css("opacity",1);for(var t=f.startingItem-1,e=1;e<=g.rightItemsCount;e++)t<g.totalItems-1?t+=1:t=0,g.items[t].css("opacity",1),o(g.items[t],e);for(t=f.startingItem-1,e=-1;e>=-1*g.leftItemsCount;e--)0<t?t-=1:t=g.totalItems-1,g.items[t].css("opacity",1),o(g.items[t],e)}()})},this.next=function(){i(!0),f.autoPlay=0,a("forward")},this.prev=function(){i(!0),f.autoPlay=0,a("backward")},this.reload(t),this.swipe({swipeStatus:function(t,e,i){if("end"===e)if("right"===i)a("backward");else{if("left"!==i)return!1;a("forward")}},triggerOnTouchStart:!1,triggerOnTouchEnd:!1,threshold:100}),this},s.fn.waterwheelCarousel.defaults={startingItem:1,separation:175,separationMultiplier:.6,horizonOffset:0,horizonOffsetMultiplier:1,sizeMultiplier:.7,opacityMultiplier:.8,horizon:0,flankingItems:3,speed:300,animationEasing:"linear",quickerForFurther:!0,edgeFadeEnabled:!1,linkHandling:2,autoPlay:0,orientation:"horizontal",activeClassName:"carousel-center",keyboardNav:!1,keyboardNavOverride:!0,imageNav:!0,preloadImages:!0,forcedImageWidth:0,forcedImageHeight:0,movingToCenter:s.noop,movedToCenter:s.noop,clickedCenter:s.noop,movingFromCenter:s.noop,movedFromCenter:s.noop}}(jQuery);